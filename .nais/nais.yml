apiVersion: nais.io/v1alpha1
kind: Application
metadata:
  name: tiltakspenger-dokument
  namespace: tpts
  labels:
    team: tpts
spec:
  image: {{ image }}
  port: 8080
# Hvis det trengs en ingress så må den lages så den er ulik for dev og prod
#  ingresses:
#    - https://{{ name }}.intern.dev.nav.no
  azure:
    application:
      enabled: true
  liveness:
    path: /isalive
  readiness:
    path: /isready
  prometheus:
    enabled: true
    path: /metrics
  replicas:
    min: 1
    max: 1
  kafka:
    pool: {{ kafka.pool }}
  secureLogs:
    enabled: true
    accessPolicy:
      inbound:
        rules:
          - application: tiltakspenger-soknad-api
            namespace: tpts
            cluster: { { cluster } }
      outbound:
        rules:
          - application: tiltakspenger-pdfgen
        external:
  env:
    - name: JOARK_ENDPOINT_URL
      value: {{ endpoints.joark }}
    - name: JOARK_AUDIENCE
      value: {{ audience.joark }}
    - name: JOARK_SCOPE
      value: {{ scope.joark }}
    - name: PDF_ENDPOINT_URL
      value: {{ endpoints.pdf }}
